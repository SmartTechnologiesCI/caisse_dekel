<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="Tablix1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1.5in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <!-- Ligne de détail -->
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Vehicle_Registration_No_">
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Vehicle_Registration_No_.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Date_validation">
                      <CanGrow>true</CanGrow>
                      <Value>=Format(Fields!Date_validation.Value, "dd/MM/yyyy HH:mm")</Value>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Ticket_Planteur">
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Ticket_Planteur.Value</Value>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="POIDS_ENTREE">
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!POIDS_ENTREE.Value</Value>
                      <Style>
                        <Format=N0</Format>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="POIDS_SORTIE">
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!POIDS_SORTIE.Value</Value>
                      <Style>
                        <Format>N0</Format>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="POIDS_NET">
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!POIDS_NET.Value</Value>
                      <Style>
                        <Format>N0</Format>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <!-- Groupement par Centre Logistique (Nom_Client) -->
            <TablixMember>
              <Group Name="Group_Nom_Client">
                <GroupExpressions>
                  <GroupExpression>=Fields!Nom_Client.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <TablixHeader>
                <Size>0.4in</Size>
                <CellContents>
                  <Textbox Name="Header_Nom_Client">
                    <Value>= "Centre Logistique : " & Fields!Nom_Client.Value</Value>
                    <Style>
                      <BackgroundColor>#1c3b6e</BackgroundColor>
                      <Color>White</Color>
                      <FontSize>12pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <PaddingLeft>4pt</PaddingLeft>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <!-- Sous-groupement par Type opération -->
                <TablixMember>
                  <Group Name="Group_TypeOperation">
                    <GroupExpressions>
                      <GroupExpression>=Fields!Type_opération.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixHeader>
                    <Size>0.35in</Size>
                    <CellContents>
                      <Textbox Name="Header_TypeOperation">
                        <Value>= "Type opération : " & Fields!Type_opération.Value</Value>
                        <Style>
                          <BackgroundColor>#4a6ea9</BackgroundColor>
                          <Color>White</Color>
                          <FontWeight>Bold</FontWeight>
                          <PaddingLeft>8pt</PaddingLeft>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <!-- Ligne de détail (déjà définie plus haut) -->
                    <TablixMember>
                      <KeepWithGroup>After</KeepWithGroup>
                    </TablixMember>
                    <!-- Total par Type opération -->
                    <TablixMember>
                      <TablixHeader>
                        <Size>0.3in</Size>
                        <CellContents>
                          <Rectangle Name="RectTotalType">
                            <ReportItems>
                              <Textbox Name="TxtTotalType">
                                <Value>="Total =Fields!Type_opération.Value & " : "</Value>
                                <Style>
                                  <FontWeight>Bold</FontWeight>
                                  <Border>
                                    <Style>Solid</Style>
                                  </Border>
                                  <PaddingLeft>8pt</PaddingLeft>
                                </Style>
                              </Textbox>
                              <Textbox Name="Total_PoidsNet_Type">
                                <Value>=Sum(Fields!POIDS_NET.Value)</Value>
                                <Style>
                                  <FontWeight>Bold</FontWeight>
                                  <Format>N0 kg</Format>
                                </Style>
                                <Left>5.5in</Left>
                              </Textbox>
                            </ReportItems>
                          </Rectangle>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
                <!-- Grand total par Centre Logistique -->
                <TablixMember>
                  <TablixHeader>
                    <Size>0.4in</Size>
                    <CellContents>
                      <Rectangle Name="RectGrandTotal">
                        <ReportItems>
                          <Textbox Name="TxtGrandTotal">
                            <Value>="TOTAL CENTRE " & Fields!Nom_Client.Value & " : "</Value>
                            <Style>
                              <BackgroundColor>#1c3b6e</BackgroundColor>
                              <Color>White</Color>
                              <FontSize>11pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <PaddingLeft>4pt</PaddingLeft>
                            </Style>
                          </Textbox>
                          <Textbox Name="GrandTotal_PoidsNet">
                            <Value>=Sum(Fields!POIDS_NET.Value)</Value>
                            <Style>
                              <BackgroundColor>#1c3b6e</BackgroundColor>
                              <Color>White</Color>
                              <FontWeight>Bold</FontWeight>
                              <Format>N0 kg</Format>
                            </Style>
                            <Left>5.5in</Left>
                          </Textbox>
                        </ReportItems>
                      </Rectangle>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet_Result</DataSetName>
        <Height>2in</Height>
        <Width>9in</Width>
        <Style />
      </Tablix>
    </ReportItems>
    <Height>5in</Height>
  </Body>
  <Width>10in</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <LeftMargin>1cm</LeftMargin>
    <RightMargin>1cm</RightMargin>
    <TopMargin>1cm</TopMargin>
    <BottomMargin>1cm</BottomMargin>
  </Page>
  <rd:ReportID>rapport-client-fournisseur</rd:ReportID>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
</Report>